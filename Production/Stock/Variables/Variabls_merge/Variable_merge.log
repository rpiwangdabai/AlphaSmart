Tue, 06 Oct 2020 00:42:50 temp_script.py[line:201] ERROR 错误日志：
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 583, in connect
    **kwargs)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/socket.py", line 724, in create_connection
    raise err
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/socket.py", line 713, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2285, in _wrap_pool_connect
    return fn()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 363, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 773, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 492, in checkout
    rec = pool._do_get()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/impl.py", line 139, in _do_get
    self._dec_overflow()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 69, in __exit__
    exc_value, with_traceback=exc_tb,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/impl.py", line 136, in _do_get
    return self._create_connection()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 308, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 437, in __init__
    self.__connect(first_connect_check=True)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 657, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 69, in __exit__
    exc_value, with_traceback=exc_tb,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 652, in __connect
    connection = pool._invoke_creator(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 488, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 630, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/multiprocessing/pool.py", line 119, in worker
    result = (True, func(*args, **kwds))
  File "/Users/Roy/Documents/Investment/Production/Stock/Variables/Variabls_merge/temp_script.py", line 40, in variable_data_merge
    cur = conn.execute('''SHOW TABLES''')
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2190, in execute
    connection = self._contextual_connect(close_with_result=True)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2251, in _contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2289, in _wrap_pool_connect
    e, dialect, self
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1555, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2285, in _wrap_pool_connect
    return fn()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 363, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 773, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 492, in checkout
    rec = pool._do_get()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/impl.py", line 139, in _do_get
    self._dec_overflow()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 69, in __exit__
    exc_value, with_traceback=exc_tb,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/impl.py", line 136, in _do_get
    return self._create_connection()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 308, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 437, in __init__
    self.__connect(first_connect_check=True)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 657, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 69, in __exit__
    exc_value, with_traceback=exc_tb,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 652, in __connect
    connection = pool._invoke_creator(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 488, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 630, in connect
    raise exc
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: http://sqlalche.me/e/e3q8)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Variables/Variabls_merge/temp_script.py", line 198, in <module>
    result_merge(results, saving_address, saving_address_statistic,data_base_name)
  File "/Users/Roy/Documents/Investment/Production/Stock/Variables/Variabls_merge/temp_script.py", line 99, in result_merge
    columns = results[0].get()[2]
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/multiprocessing/pool.py", line 644, in get
    raise self._value
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (2003, "Can't connect to MySQL server on 'localhost' ([Errno 61] Connection refused)")
(Background on this error at: http://sqlalche.me/e/e3q8)

Tue, 06 Oct 2020 00:44:40 temp_script.py[line:125] INFO stock_daily_capital variable merge ssuccessfully!
Tue, 06 Oct 2020 00:59:51 temp_script.py[line:239] ERROR 错误日志：
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2285, in _wrap_pool_connect
    return fn()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 363, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 773, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 492, in checkout
    rec = pool._do_get()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/impl.py", line 139, in _do_get
    self._dec_overflow()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 69, in __exit__
    exc_value, with_traceback=exc_tb,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/impl.py", line 136, in _do_get
    return self._create_connection()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 308, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 437, in __init__
    self.__connect(first_connect_check=True)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 657, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 69, in __exit__
    exc_value, with_traceback=exc_tb,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 652, in __connect
    connection = pool._invoke_creator(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 488, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 599, in connect
    self._request_authentication()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 882, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/_auth.py", line 238, in caching_sha2_password_auth
    pkt = conn._read_packet()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 684, in _read_packet
    packet.check_error()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/protocol.py", line 220, in check_error
    err.raise_mysql_exception(self._data)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/err.py", line 109, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.InternalError: (1049, "Unknown database 'stock_daily_basic'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/multiprocessing/pool.py", line 119, in worker
    result = (True, func(*args, **kwds))
  File "/Users/Roy/Documents/Investment/Production/Stock/Variables/Variabls_merge/temp_script.py", line 40, in variable_data_merge
    cur = conn.execute('''SHOW TABLES''')
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2190, in execute
    connection = self._contextual_connect(close_with_result=True)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2251, in _contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2289, in _wrap_pool_connect
    e, dialect, self
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1555, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2285, in _wrap_pool_connect
    return fn()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 363, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 773, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 492, in checkout
    rec = pool._do_get()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/impl.py", line 139, in _do_get
    self._dec_overflow()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 69, in __exit__
    exc_value, with_traceback=exc_tb,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/impl.py", line 136, in _do_get
    return self._create_connection()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 308, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 437, in __init__
    self.__connect(first_connect_check=True)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 657, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 69, in __exit__
    exc_value, with_traceback=exc_tb,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 652, in __connect
    connection = pool._invoke_creator(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 488, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 599, in connect
    self._request_authentication()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 882, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/_auth.py", line 238, in caching_sha2_password_auth
    pkt = conn._read_packet()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 684, in _read_packet
    packet.check_error()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/protocol.py", line 220, in check_error
    err.raise_mysql_exception(self._data)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/err.py", line 109, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.InternalError: (pymysql.err.InternalError) (1049, "Unknown database 'stock_daily_basic'")
(Background on this error at: http://sqlalche.me/e/2j85)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Variables/Variabls_merge/temp_script.py", line 236, in <module>
    result_merge(results, saving_address, saving_address_statistic,data_base_name)
  File "/Users/Roy/Documents/Investment/Production/Stock/Variables/Variabls_merge/temp_script.py", line 99, in result_merge
    columns = results[0].get()[2]
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/multiprocessing/pool.py", line 644, in get
    raise self._value
sqlalchemy.exc.InternalError: (pymysql.err.InternalError) (1049, "Unknown database 'stock_daily_basic'")
(Background on this error at: http://sqlalche.me/e/2j85)

Tue, 06 Oct 2020 01:06:07 temp_script.py[line:126] INFO stocks_daily_basic variable merge ssuccessfully!
Tue, 06 Oct 2020 01:06:07 temp_script.py[line:240] ERROR 错误日志：
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Variables/Variabls_merge/temp_script.py", line 237, in <module>
    result_merge(results, saving_address, saving_address_statistic,data_base_name)
  File "/Users/Roy/Documents/Investment/Production/Stock/Variables/Variabls_merge/temp_script.py", line 143, in result_merge
    temp.to_csv(csv_address, index = False)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/core/generic.py", line 3228, in to_csv
    formatter.save()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/formats/csvs.py", line 183, in save
    compression=self.compression,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/common.py", line 399, in _get_handle
    f = open(path_or_buf, mode, encoding=encoding, newline="")
FileNotFoundError: [Errno 2] No such file or directory: '/Users/Roy/Documents/Investment/data/stocks_daily_basic/close.csv'

Tue, 06 Oct 2020 01:08:07 temp_script.py[line:126] INFO stock_daily_basic variable merge ssuccessfully!
Tue, 06 Oct 2020 01:28:25 temp_script.py[line:126] INFO stock_daily_capital_flow variable merge ssuccessfully!
Tue, 06 Oct 2020 01:29:08 temp_script.py[line:126] INFO stock_daily_basic variable merge ssuccessfully!
