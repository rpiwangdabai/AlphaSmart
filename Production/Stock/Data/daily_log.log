Thu, 06 Aug 2020 15:28:55 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 15:35:08 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 15:36:06 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 15:36:07 stock_daily_basic.py[line:121] ERROR ¥ÌŒÛ»’÷æ£∫
Traceback (most recent call last):
  File "D:\RoyMa\Python\Investment\Production\Stock\Data\individual_stock_data\basic\stock_daily_basic.py", line 119, in run
    self.get_data_and_save_bulk()
  File "D:\RoyMa\Python\Investment\Production\Stock\Data\individual_stock_data\basic\stock_daily_basic.py", line 97, in get_data_and_save_bulk
    pd.io.sql.to_sql(data, tick, self.conn,index = None,if_exists = 'replace') ## change
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 521, in to_sql
    method=method,
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 1316, in to_sql
    table.create()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 648, in create
    self.pd_sql.drop_table(self.name, self.schema)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 1363, in drop_table
    self.meta.reflect(only=[table_name], schema=schema)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\sql\schema.py", line 4261, in reflect
    "in %r%s: (%s)" % (bind.engine, s, ", ".join(missing))
sqlalchemy.exc.InvalidRequestError: Could not reflect: requested table(s) not available in Engine(mysql+pymysql://root:***@localhost:3306/stocks_daily_basic): (000001.SZ)

Thu, 06 Aug 2020 15:36:36 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 15:36:37 stock_daily_basic.py[line:121] ERROR ¥ÌŒÛ»’÷æ£∫
Traceback (most recent call last):
  File "D:\RoyMa\Python\Investment\Production\Stock\Data\individual_stock_data\basic\stock_daily_basic.py", line 119, in run
    self.get_data_and_save_bulk()
  File "D:\RoyMa\Python\Investment\Production\Stock\Data\individual_stock_data\basic\stock_daily_basic.py", line 97, in get_data_and_save_bulk
    pd.io.sql.to_sql(data, tick, self.conn,index = None,if_exists = 'replace') ## change
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 521, in to_sql
    method=method,
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 1316, in to_sql
    table.create()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 648, in create
    self.pd_sql.drop_table(self.name, self.schema)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 1363, in drop_table
    self.meta.reflect(only=[table_name], schema=schema)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\sql\schema.py", line 4261, in reflect
    "in %r%s: (%s)" % (bind.engine, s, ", ".join(missing))
sqlalchemy.exc.InvalidRequestError: Could not reflect: requested table(s) not available in Engine(mysql+pymysql://root:***@localhost:3306/stocks_daily_basic): (000001.SZ)

Thu, 06 Aug 2020 15:36:59 stock_daily_basic.py[line:121] ERROR ¥ÌŒÛ»’÷æ£∫
Traceback (most recent call last):
  File "D:\RoyMa\Python\Investment\Production\Stock\Data\individual_stock_data\basic\stock_daily_basic.py", line 119, in run
    self.get_data_and_save_bulk()
  File "D:\RoyMa\Python\Investment\Production\Stock\Data\individual_stock_data\basic\stock_daily_basic.py", line 97, in get_data_and_save_bulk
    pd.io.sql.to_sql(data, tick, self.conn,index = None,if_exists = 'replace') ## change
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 521, in to_sql
    method=method,
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 1316, in to_sql
    table.create()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 648, in create
    self.pd_sql.drop_table(self.name, self.schema)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 1363, in drop_table
    self.meta.reflect(only=[table_name], schema=schema)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\sql\schema.py", line 4261, in reflect
    "in %r%s: (%s)" % (bind.engine, s, ", ".join(missing))
sqlalchemy.exc.InvalidRequestError: Could not reflect: requested table(s) not available in Engine(mysql+pymysql://root:***@localhost:3306/stocks_daily_basic): (000001.SZ)

Thu, 06 Aug 2020 15:38:45 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 15:56:42 stock_daily_basic.py[line:102] INFO Stock daily basic download successed !
Thu, 06 Aug 2020 15:56:54 stock_daily_basic.py[line:102] INFO Stock daily basic download successed !
Thu, 06 Aug 2020 15:57:52 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 15:57:53 stock_daily_basic.py[line:102] INFO Stock daily basic download successed !
Thu, 06 Aug 2020 16:03:32 stock_daily_capital_flow.py[line:107] INFO Stock daily capital flow update successfully!
Thu, 06 Aug 2020 16:10:18 utils.py[line:129] INFO Note: NumExpr detected 12 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
Thu, 06 Aug 2020 16:10:18 utils.py[line:141] INFO NumExpr defaulting to 8 threads.
Thu, 06 Aug 2020 16:10:19 stock_daily_price.py[line:107] INFO Stock daily price_None data download successed!
Thu, 06 Aug 2020 16:10:20 stock_daily_price.py[line:107] INFO Stock daily price_hfq data download successed!
Thu, 06 Aug 2020 16:10:25 stock_daily_price.py[line:107] INFO Stock daily price_None data download successed!
Thu, 06 Aug 2020 16:10:26 stock_daily_price.py[line:107] INFO Stock daily price_hfq data download successed!
Thu, 06 Aug 2020 16:10:28 stock_daily_price.py[line:107] INFO Stock daily price_qfq data download successed!
Thu, 06 Aug 2020 16:15:32 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:15:33 stock_daily_basic.py[line:102] INFO Stock daily basic download successed !
Thu, 06 Aug 2020 16:16:03 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:16:04 stock_daily_basic.py[line:102] INFO Stock daily basic download successed !
Thu, 06 Aug 2020 16:16:05 stock_daily_capital_flow.py[line:107] INFO Stock daily capital flow update successfully!
Thu, 06 Aug 2020 16:16:06 stock_daily_price.py[line:126] ERROR ¥ÌŒÛ»’÷æ£∫
Traceback (most recent call last):
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\base.py", line 2276, in _wrap_pool_connect
    return fn()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 363, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 773, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 492, in checkout
    rec = pool._do_get()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\impl.py", line 139, in _do_get
    self._dec_overflow()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\util\langhelpers.py", line 68, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\util\compat.py", line 153, in reraise
    raise value
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\impl.py", line 136, in _do_get
    return self._create_connection()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 308, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 437, in __init__
    self.__connect(first_connect_check=True)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 652, in __connect
    connection = pool._invoke_creator(self)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\default.py", line 489, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 327, in __init__
    self.connect()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 588, in connect
    self._request_authentication()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 853, in _request_authentication
    auth_packet = self._read_packet()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 676, in _read_packet
    packet.raise_for_error()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\protocol.py", line 223, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1049, "Unknown database 'stocks_daily'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\RoyMa\Python\Investment\Production\Stock\Data\individual_stock_data\price\stock_daily_price.py", line 122, in run
    self.get_data_and_save_bulk('None')
  File "D:\RoyMa\Python\Investment\Production\Stock\Data\individual_stock_data\price\stock_daily_price.py", line 101, in get_data_and_save_bulk
    pd.io.sql.to_sql(data, str.lower(table_name), self.conn,index = None,if_exists = 'replace') ## change
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 521, in to_sql
    method=method,
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 1316, in to_sql
    table.create()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 644, in create
    if self.exists():
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 631, in exists
    return self.pd_sql.has_table(self.name, self.schema)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 1341, in has_table
    self.connectable.dialect.has_table, name, schema or self.meta.schema
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\base.py", line 2162, in run_callable
    with self._contextual_connect() as conn:
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\base.py", line 2242, in _contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\base.py", line 2280, in _wrap_pool_connect
    e, dialect, self
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\base.py", line 1547, in _handle_dbapi_exception_noconnection
    util.raise_from_cause(sqlalchemy_exception, exc_info)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\util\compat.py", line 398, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\util\compat.py", line 152, in reraise
    raise value.with_traceback(tb)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\base.py", line 2276, in _wrap_pool_connect
    return fn()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 363, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 773, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 492, in checkout
    rec = pool._do_get()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\impl.py", line 139, in _do_get
    self._dec_overflow()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\util\langhelpers.py", line 68, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\util\compat.py", line 153, in reraise
    raise value
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\impl.py", line 136, in _do_get
    return self._create_connection()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 308, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 437, in __init__
    self.__connect(first_connect_check=True)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 652, in __connect
    connection = pool._invoke_creator(self)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\default.py", line 489, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 327, in __init__
    self.connect()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 588, in connect
    self._request_authentication()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 853, in _request_authentication
    auth_packet = self._read_packet()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 676, in _read_packet
    packet.raise_for_error()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\protocol.py", line 223, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1049, "Unknown database 'stocks_daily'")
(Background on this error at: http://sqlalche.me/e/e3q8)

Thu, 06 Aug 2020 16:17:55 stock_daily_price.py[line:107] INFO Stock daily price_None data download successed!
Thu, 06 Aug 2020 16:17:56 stock_daily_price.py[line:107] INFO Stock daily price_hfq data download successed!
Thu, 06 Aug 2020 16:17:57 stock_daily_price.py[line:107] INFO Stock daily price_qfq data download successed!
Thu, 06 Aug 2020 16:18:02 stock_daily_capital_flow.py[line:107] INFO Stock daily capital flow update successfully!
Thu, 06 Aug 2020 16:18:10 stock_daily_price.py[line:126] ERROR ¥ÌŒÛ»’÷æ£∫
Traceback (most recent call last):
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\base.py", line 2276, in _wrap_pool_connect
    return fn()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 363, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 773, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 492, in checkout
    rec = pool._do_get()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\impl.py", line 139, in _do_get
    self._dec_overflow()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\util\langhelpers.py", line 68, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\util\compat.py", line 153, in reraise
    raise value
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\impl.py", line 136, in _do_get
    return self._create_connection()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 308, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 437, in __init__
    self.__connect(first_connect_check=True)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 652, in __connect
    connection = pool._invoke_creator(self)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\default.py", line 489, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 327, in __init__
    self.connect()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 588, in connect
    self._request_authentication()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 853, in _request_authentication
    auth_packet = self._read_packet()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 676, in _read_packet
    packet.raise_for_error()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\protocol.py", line 223, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1049, "Unknown database 'stocks_daily'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\RoyMa\Python\Investment\Production\Stock\Data\individual_stock_data\price\stock_daily_price.py", line 122, in run
    self.get_data_and_save_bulk('None')
  File "D:\RoyMa\Python\Investment\Production\Stock\Data\individual_stock_data\price\stock_daily_price.py", line 101, in get_data_and_save_bulk
    pd.io.sql.to_sql(data, str.lower(table_name), self.conn,index = None,if_exists = 'replace') ## change
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 521, in to_sql
    method=method,
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 1316, in to_sql
    table.create()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 644, in create
    if self.exists():
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 631, in exists
    return self.pd_sql.has_table(self.name, self.schema)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pandas\io\sql.py", line 1341, in has_table
    self.connectable.dialect.has_table, name, schema or self.meta.schema
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\base.py", line 2162, in run_callable
    with self._contextual_connect() as conn:
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\base.py", line 2242, in _contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\base.py", line 2280, in _wrap_pool_connect
    e, dialect, self
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\base.py", line 1547, in _handle_dbapi_exception_noconnection
    util.raise_from_cause(sqlalchemy_exception, exc_info)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\util\compat.py", line 398, in raise_from_cause
    reraise(type(exception), exception, tb=exc_tb, cause=cause)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\util\compat.py", line 152, in reraise
    raise value.with_traceback(tb)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\base.py", line 2276, in _wrap_pool_connect
    return fn()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 363, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 773, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 492, in checkout
    rec = pool._do_get()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\impl.py", line 139, in _do_get
    self._dec_overflow()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\util\langhelpers.py", line 68, in __exit__
    compat.reraise(exc_type, exc_value, exc_tb)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\util\compat.py", line 153, in reraise
    raise value
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\impl.py", line 136, in _do_get
    return self._create_connection()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 308, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 437, in __init__
    self.__connect(first_connect_check=True)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\pool\base.py", line 652, in __connect
    connection = pool._invoke_creator(self)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\sqlalchemy\engine\default.py", line 489, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 327, in __init__
    self.connect()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 588, in connect
    self._request_authentication()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 853, in _request_authentication
    auth_packet = self._read_packet()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\connections.py", line 676, in _read_packet
    packet.raise_for_error()
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\protocol.py", line 223, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "C:\Users\Lenovo\anaconda3\lib\site-packages\pymysql\err.py", line 107, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1049, "Unknown database 'stocks_daily'")
(Background on this error at: http://sqlalche.me/e/e3q8)

Thu, 06 Aug 2020 16:18:48 stock_daily_price.py[line:107] INFO Stock daily price_None data download successed!
Thu, 06 Aug 2020 16:18:50 stock_daily_price.py[line:107] INFO Stock daily price_hfq data download successed!
Thu, 06 Aug 2020 16:18:51 stock_daily_price.py[line:107] INFO Stock daily price_qfq data download successed!
Thu, 06 Aug 2020 16:18:56 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:18:57 stock_daily_basic.py[line:102] INFO Stock daily basic download successed !
Thu, 06 Aug 2020 16:18:57 stock_daily_capital_flow.py[line:107] INFO Stock daily capital flow update successfully!
Thu, 06 Aug 2020 16:18:59 stock_daily_price.py[line:107] INFO Stock daily price_None data download successed!
Thu, 06 Aug 2020 16:19:00 stock_daily_price.py[line:107] INFO Stock daily price_hfq data download successed!
Thu, 06 Aug 2020 16:19:01 stock_daily_price.py[line:107] INFO Stock daily price_qfq data download successed!
Thu, 06 Aug 2020 16:19:06 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:19:08 stock_daily_basic.py[line:102] INFO Stock daily basic download successed !
Thu, 06 Aug 2020 16:19:09 stock_daily_capital_flow.py[line:107] INFO Stock daily capital flow update successfully!
Thu, 06 Aug 2020 16:19:11 stock_daily_price.py[line:107] INFO Stock daily price_None data download successed!
Thu, 06 Aug 2020 16:19:12 stock_daily_price.py[line:107] INFO Stock daily price_hfq data download successed!
Thu, 06 Aug 2020 16:19:13 stock_daily_price.py[line:107] INFO Stock daily price_qfq data download successed!
Thu, 06 Aug 2020 16:37:31 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:37:32 stock_daily_basic.py[line:102] INFO Stock daily basic download successed !
Thu, 06 Aug 2020 16:37:33 stock_daily_capital_flow.py[line:107] INFO Stock daily capital flow update successfully!
Thu, 06 Aug 2020 16:37:36 stock_daily_price.py[line:107] INFO Stock daily price_None data download successed!
Thu, 06 Aug 2020 16:37:38 stock_daily_price.py[line:107] INFO Stock daily price_hfq data download successed!
Thu, 06 Aug 2020 16:37:41 stock_daily_price.py[line:107] INFO Stock daily price_qfq data download successed!
Thu, 06 Aug 2020 16:38:05 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:38:48 listed_data.py[line:77] INFO Job starting time at 06/08/2020 04:38:48
Thu, 06 Aug 2020 16:38:48 listed_data.py[line:78] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:38:49 listed_data.py[line:77] INFO Job starting time at 06/08/2020 04:38:49
Thu, 06 Aug 2020 16:38:49 listed_data.py[line:78] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:39:13 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:39:33 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:41:14 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:41:33 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:42:40 listed_data.py[line:91] INFO Job starting time at 06/08/2020 04:42:40
Thu, 06 Aug 2020 16:42:42 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:43:00 listed_data.py[line:91] INFO Job starting time at 06/08/2020 04:43:00
Thu, 06 Aug 2020 16:43:01 listed_data.py[line:77] INFO listed stock list updated successfully!
Thu, 06 Aug 2020 16:43:03 stock_daily_basic.py[line:102] INFO Stock daily basic download successed !
Thu, 06 Aug 2020 16:43:05 stock_daily_capital_flow.py[line:107] INFO Stock daily capital flow update successfully!
Thu, 06 Aug 2020 16:43:07 stock_daily_price.py[line:107] INFO Stock daily price_None data download successed!
Thu, 06 Aug 2020 16:43:12 stock_daily_price.py[line:107] INFO Stock daily price_hfq data download successed!
Thu, 06 Aug 2020 16:43:14 stock_daily_price.py[line:107] INFO Stock daily price_qfq data download successed!
Wed, 26 Aug 2020 17:41:07 listed_data.py[line:91] INFO Job starting time at 26/08/2020 05:41:07
Wed, 26 Aug 2020 17:41:09 listed_data.py[line:77] INFO listed stock list updated successfully!
Wed, 26 Aug 2020 17:41:11 stock_daily_basic.py[line:102] INFO Stock daily basic download successed !
Wed, 26 Aug 2020 17:41:12 stock_daily_capital_flow.py[line:107] INFO Stock daily capital flow update successfully!
Wed, 26 Aug 2020 17:41:15 utils.py[line:129] INFO Note: NumExpr detected 12 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
Wed, 26 Aug 2020 17:41:15 utils.py[line:141] INFO NumExpr defaulting to 8 threads.
Wed, 26 Aug 2020 17:41:15 stock_daily_price.py[line:107] INFO Stock daily price_None data download successed!
Wed, 26 Aug 2020 17:41:19 stock_daily_price.py[line:107] INFO Stock daily price_hfq data download successed!
Wed, 26 Aug 2020 17:41:22 stock_daily_price.py[line:107] INFO Stock daily price_qfq data download successed!
Wed, 26 Aug 2020 17:43:04 listed_data.py[line:91] INFO Job starting time at 26/08/2020 05:43:04
Wed, 26 Aug 2020 17:43:06 listed_data.py[line:77] INFO listed stock list updated successfully!
Wed, 26 Aug 2020 19:07:38 stock_daily_basic.py[line:102] INFO Stock daily basic download successed !
Wed, 26 Aug 2020 20:19:54 stock_daily_capital_flow.py[line:107] INFO Stock daily capital flow update successfully!
Wed, 26 Aug 2020 21:29:03 stock_daily_price.py[line:107] INFO Stock daily price_None data download successed!
Wed, 26 Aug 2020 22:13:05 stock_daily_price.py[line:107] INFO Stock daily price_hfq data download successed!
Wed, 26 Aug 2020 22:59:45 stock_daily_price.py[line:107] INFO Stock daily price_qfq data download successed!
Fri, 18 Sep 2020 21:57:33 listed_data.py[line:91] INFO Job starting time at 18/09/2020 09:57:33
Fri, 18 Sep 2020 21:57:34 listed_data.py[line:77] INFO listed stock list updated successfully!
Fri, 18 Sep 2020 21:57:34 stock_daily_basic.py[line:121] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/basic/stock_daily_basic.py", line 119, in run
    self.get_data_and_save_bulk()
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/basic/stock_daily_basic.py", line 97, in get_data_and_save_bulk
    pd.io.sql.to_sql(data, str.lower(tick), self.conn,index = None,if_exists = 'replace') ## change
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 518, in to_sql
    method=method,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1319, in to_sql
    table.create()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 647, in create
    self.pd_sql.drop_table(self.name, self.schema)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1366, in drop_table
    self.meta.reflect(only=[table_name], schema=schema)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/sql/schema.py", line 4266, in reflect
    "in %r%s: (%s)" % (bind.engine, s, ", ".join(missing))
sqlalchemy.exc.InvalidRequestError: Could not reflect: requested table(s) not available in Engine(mysql+pymysql://root:***@localhost:3306/stocks_daily_basic): (688600.sh)

Fri, 18 Sep 2020 21:58:21 stock_daily_capital_flow.py[line:125] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/capitalflow/stock_daily_capital_flow.py", line 91, in get_data_and_save_bulk
    data = self.ts_pro.moneyflow(ts_code=tick)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/tushare/pro/client.py", line 44, in query
    raise Exception(result['msg'])
Exception: Êä±Ê≠âÔºåÊÇ®ÊØèÂàÜÈíüÊúÄÂ§öËÆøÈóÆËØ•Êé•Âè£300Ê¨°ÔºåÊùÉÈôêÁöÑÂÖ∑‰ΩìËØ¶ÊÉÖËÆøÈóÆÔºöhttps://tushare.pro/document/1?doc_id=108„ÄÇ

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/capitalflow/stock_daily_capital_flow.py", line 122, in run
    self.get_data_and_save_bulk()
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/capitalflow/stock_daily_capital_flow.py", line 93, in get_data_and_save_bulk
    data = self.ts_pro.moneyflow(ts_code=tick)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/tushare/pro/client.py", line 44, in query
    raise Exception(result['msg'])
Exception: Êä±Ê≠âÔºåÊÇ®ÊØèÂàÜÈíüÊúÄÂ§öËÆøÈóÆËØ•Êé•Âè£300Ê¨°ÔºåÊùÉÈôêÁöÑÂÖ∑‰ΩìËØ¶ÊÉÖËÆøÈóÆÔºöhttps://tushare.pro/document/1?doc_id=108„ÄÇ

Fri, 18 Sep 2020 21:58:24 stock_daily_price.py[line:126] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 122, in run
    self.get_data_and_save_bulk('None')
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 93, in get_data_and_save_bulk
    if data.empty:
AttributeError: 'NoneType' object has no attribute 'empty'

Fri, 18 Sep 2020 22:00:36 stock_daily_basic.py[line:121] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/basic/stock_daily_basic.py", line 119, in run
    self.get_data_and_save_bulk()
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/basic/stock_daily_basic.py", line 97, in get_data_and_save_bulk
    pd.io.sql.to_sql(data, str.lower(tick), self.conn,index = None,if_exists = 'replace') ## change
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 518, in to_sql
    method=method,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1319, in to_sql
    table.create()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 647, in create
    self.pd_sql.drop_table(self.name, self.schema)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1366, in drop_table
    self.meta.reflect(only=[table_name], schema=schema)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/sql/schema.py", line 4266, in reflect
    "in %r%s: (%s)" % (bind.engine, s, ", ".join(missing))
sqlalchemy.exc.InvalidRequestError: Could not reflect: requested table(s) not available in Engine(mysql+pymysql://root:***@localhost:3306/stocks_daily_basic): (688600.sh)

Fri, 18 Sep 2020 22:00:38 stock_daily_basic.py[line:121] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/basic/stock_daily_basic.py", line 119, in run
    self.get_data_and_save_bulk()
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/basic/stock_daily_basic.py", line 97, in get_data_and_save_bulk
    pd.io.sql.to_sql(data, str.lower(tick), self.conn,index = None,if_exists = 'replace') ## change
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 518, in to_sql
    method=method,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1319, in to_sql
    table.create()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 647, in create
    self.pd_sql.drop_table(self.name, self.schema)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1366, in drop_table
    self.meta.reflect(only=[table_name], schema=schema)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/sql/schema.py", line 4266, in reflect
    "in %r%s: (%s)" % (bind.engine, s, ", ".join(missing))
sqlalchemy.exc.InvalidRequestError: Could not reflect: requested table(s) not available in Engine(mysql+pymysql://root:***@localhost:3306/stocks_daily_basic): (688600.sh)

Fri, 18 Sep 2020 22:02:43 stock_daily_basic.py[line:121] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/basic/stock_daily_basic.py", line 119, in run
    self.get_data_and_save_bulk()
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/basic/stock_daily_basic.py", line 97, in get_data_and_save_bulk
    pd.io.sql.to_sql(data, str.lower(tick), self.conn,index = None,if_exists = 'replace') ## change
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 518, in to_sql
    method=method,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1319, in to_sql
    table.create()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 647, in create
    self.pd_sql.drop_table(self.name, self.schema)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1366, in drop_table
    self.meta.reflect(only=[table_name], schema=schema)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/sql/schema.py", line 4266, in reflect
    "in %r%s: (%s)" % (bind.engine, s, ", ".join(missing))
sqlalchemy.exc.InvalidRequestError: Could not reflect: requested table(s) not available in Engine(mysql+pymysql://root:***@localhost:3306/stocks_daily_basic): (688600.sh)

Fri, 18 Sep 2020 22:21:50 listed_data.py[line:91] INFO Job starting time at 18/09/2020 10:21:50
Fri, 18 Sep 2020 22:21:51 listed_data.py[line:77] INFO listed stock list updated successfully!
Fri, 18 Sep 2020 22:58:05 stock_daily_basic.py[line:105] WARNING some data download failed, check error ticks
Fri, 18 Sep 2020 22:58:05 stock_daily_basic.py[line:106] WARNING ['688536.SH', '688127.SH', '605116.SH', '003006.SZ', '003003.SZ']
Fri, 18 Sep 2020 22:58:58 stock_daily_capital_flow.py[line:125] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/capitalflow/stock_daily_capital_flow.py", line 91, in get_data_and_save_bulk
    data = self.ts_pro.moneyflow(ts_code=tick)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/tushare/pro/client.py", line 44, in query
    raise Exception(result['msg'])
Exception: Êä±Ê≠âÔºåÊÇ®ÊØèÂàÜÈíüÊúÄÂ§öËÆøÈóÆËØ•Êé•Âè£300Ê¨°ÔºåÊùÉÈôêÁöÑÂÖ∑‰ΩìËØ¶ÊÉÖËÆøÈóÆÔºöhttps://tushare.pro/document/1?doc_id=108„ÄÇ

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/capitalflow/stock_daily_capital_flow.py", line 122, in run
    self.get_data_and_save_bulk()
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/capitalflow/stock_daily_capital_flow.py", line 93, in get_data_and_save_bulk
    data = self.ts_pro.moneyflow(ts_code=tick)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/tushare/pro/client.py", line 44, in query
    raise Exception(result['msg'])
Exception: Êä±Ê≠âÔºåÊÇ®ÊØèÂàÜÈíüÊúÄÂ§öËÆøÈóÆËØ•Êé•Âè£300Ê¨°ÔºåÊùÉÈôêÁöÑÂÖ∑‰ΩìËØ¶ÊÉÖËÆøÈóÆÔºöhttps://tushare.pro/document/1?doc_id=108„ÄÇ

Fri, 18 Sep 2020 22:59:03 stock_daily_price.py[line:126] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 122, in run
    self.get_data_and_save_bulk('None')
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 93, in get_data_and_save_bulk
    if data.empty:
AttributeError: 'NoneType' object has no attribute 'empty'

Sat, 19 Sep 2020 11:01:02 stock_daily_capital_flow.py[line:125] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/capitalflow/stock_daily_capital_flow.py", line 91, in get_data_and_save_bulk
    data = self.ts_pro.moneyflow(ts_code=tick)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/tushare/pro/client.py", line 44, in query
    raise Exception(result['msg'])
Exception: Êä±Ê≠âÔºåÊÇ®ÊØèÂàÜÈíüÊúÄÂ§öËÆøÈóÆËØ•Êé•Âè£300Ê¨°ÔºåÊùÉÈôêÁöÑÂÖ∑‰ΩìËØ¶ÊÉÖËÆøÈóÆÔºöhttps://tushare.pro/document/1?doc_id=108„ÄÇ

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/capitalflow/stock_daily_capital_flow.py", line 122, in run
    self.get_data_and_save_bulk()
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/capitalflow/stock_daily_capital_flow.py", line 93, in get_data_and_save_bulk
    data = self.ts_pro.moneyflow(ts_code=tick)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/tushare/pro/client.py", line 44, in query
    raise Exception(result['msg'])
Exception: Êä±Ê≠âÔºåÊÇ®ÊØèÂàÜÈíüÊúÄÂ§öËÆøÈóÆËØ•Êé•Âè£300Ê¨°ÔºåÊùÉÈôêÁöÑÂÖ∑‰ΩìËØ¶ÊÉÖËÆøÈóÆÔºöhttps://tushare.pro/document/1?doc_id=108„ÄÇ

Sat, 19 Sep 2020 11:04:17 stock_daily_price.py[line:126] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 122, in run
    self.get_data_and_save_bulk('None')
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 93, in get_data_and_save_bulk
    if data.empty:
AttributeError: 'NoneType' object has no attribute 'empty'

Sat, 19 Sep 2020 11:55:35 stock_daily_capital_flow.py[line:111] WARNING some data download failed, check error ticks
Sat, 19 Sep 2020 11:55:35 stock_daily_capital_flow.py[line:112] WARNING ['688536.SH', '688127.SH', '605116.SH', '003006.SZ', '003003.SZ']
Sat, 19 Sep 2020 12:16:43 stock_daily_price.py[line:114] WARNING some data download failed, check error ticks
Sat, 19 Sep 2020 12:16:43 stock_daily_price.py[line:115] WARNING ['688536.SH', '688127.SH', '605116.SH', '003006.SZ', '003003.SZ']
Sat, 19 Sep 2020 14:28:49 stock_daily_price.py[line:130] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 90, in get_data_and_save_bulk
    data = ts.pro_bar(ts_code=tick, adj=adj)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/tushare/pro/data_pro.py", line 193, in pro_bar
    raise IOError('ERROR.')
OSError: ERROR.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 127, in run
    self.get_data_and_save_bulk('hfq')
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 92, in get_data_and_save_bulk
    data = ts.pro_bar(ts_code=tick, adj=adj)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/tushare/pro/data_pro.py", line 193, in pro_bar
    raise IOError('ERROR.')
OSError: ERROR.

Sat, 19 Sep 2020 22:42:58 stock_daily_price.py[line:114] WARNING some data download failed, check error ticks
Sat, 19 Sep 2020 22:42:58 stock_daily_price.py[line:115] WARNING ['688536.SH', '688127.SH', '605116.SH', '003006.SZ', '003003.SZ']
Sat, 19 Sep 2020 22:54:07 stock_daily_price.py[line:130] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 90, in get_data_and_save_bulk
    data = ts.pro_bar(ts_code=tick, adj=adj)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/tushare/pro/data_pro.py", line 193, in pro_bar
    raise IOError('ERROR.')
OSError: ERROR.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 127, in run
    self.get_data_and_save_bulk('hfq')
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 92, in get_data_and_save_bulk
    data = ts.pro_bar(ts_code=tick, adj=adj)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/tushare/pro/data_pro.py", line 193, in pro_bar
    raise IOError('ERROR.')
OSError: ERROR.

Sun, 20 Sep 2020 13:14:55 stock_daily_price.py[line:114] WARNING some data download failed, check error ticks
Sun, 20 Sep 2020 13:14:55 stock_daily_price.py[line:115] WARNING ['688536.SH', '688127.SH', '605116.SH', '003006.SZ', '003003.SZ']
Sun, 20 Sep 2020 13:35:40 stock_daily_price.py[line:130] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 90, in get_data_and_save_bulk
    data = ts.pro_bar(ts_code=tick, adj=adj)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/tushare/pro/data_pro.py", line 193, in pro_bar
    raise IOError('ERROR.')
OSError: ERROR.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 127, in run
    self.get_data_and_save_bulk('hfq')
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 92, in get_data_and_save_bulk
    data = ts.pro_bar(ts_code=tick, adj=adj)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/tushare/pro/data_pro.py", line 193, in pro_bar
    raise IOError('ERROR.')
OSError: ERROR.

Sun, 20 Sep 2020 14:25:29 stock_daily_price.py[line:130] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1248, in _execute_context
    cursor, statement, parameters, context
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 588, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 517, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 732, in _read_query_result
    result.read()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 1075, in read
    first_packet = self.connection._read_packet()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 684, in _read_packet
    packet.check_error()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/protocol.py", line 220, in check_error
    err.raise_mysql_exception(self._data)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/err.py", line 109, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'stocks_daily_basic_none.liseted stock list' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 126, in run
    self.get_data_and_save_bulk(status)
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 76, in get_data_and_save_bulk
    ticks_data = pd.read_sql(sql=sql_cmd, con=self.conn_ticks)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 436, in read_sql
    chunksize=chunksize,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1218, in read_query
    result = self.execute(*args)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1087, in execute
    return self.connectable.execute(*args, **kwargs)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2191, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 976, in execute
    return self._execute_text(object_, multiparams, params)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1151, in _execute_text
    parameters,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1288, in _execute_context
    e, statement, parameters, cursor, context
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1482, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1248, in _execute_context
    cursor, statement, parameters, context
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 588, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 517, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 732, in _read_query_result
    result.read()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 1075, in read
    first_packet = self.connection._read_packet()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 684, in _read_packet
    packet.check_error()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/protocol.py", line 220, in check_error
    err.raise_mysql_exception(self._data)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/err.py", line 109, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'stocks_daily_basic_none.liseted stock list' doesn't exist")
[SQL: SELECT * FROM `liseted stock list`;]
(Background on this error at: http://sqlalche.me/e/f405)

Sun, 20 Sep 2020 14:25:34 stock_daily_price.py[line:130] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1248, in _execute_context
    cursor, statement, parameters, context
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 588, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 517, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 732, in _read_query_result
    result.read()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 1075, in read
    first_packet = self.connection._read_packet()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 684, in _read_packet
    packet.check_error()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/protocol.py", line 220, in check_error
    err.raise_mysql_exception(self._data)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/err.py", line 109, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1146, "Table 'stocks_daily_basic_none.liseted stock list' doesn't exist")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 126, in run
    self.get_data_and_save_bulk(status)
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 76, in get_data_and_save_bulk
    ticks_data = pd.read_sql(sql=sql_cmd, con=self.conn_ticks)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 436, in read_sql
    chunksize=chunksize,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1218, in read_query
    result = self.execute(*args)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1087, in execute
    return self.connectable.execute(*args, **kwargs)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2191, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 976, in execute
    return self._execute_text(object_, multiparams, params)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1151, in _execute_text
    parameters,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1288, in _execute_context
    e, statement, parameters, cursor, context
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1482, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1248, in _execute_context
    cursor, statement, parameters, context
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 588, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/cursors.py", line 170, in execute
    result = self._query(query)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/cursors.py", line 328, in _query
    conn.query(q)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 517, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 732, in _read_query_result
    result.read()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 1075, in read
    first_packet = self.connection._read_packet()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 684, in _read_packet
    packet.check_error()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/protocol.py", line 220, in check_error
    err.raise_mysql_exception(self._data)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/err.py", line 109, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.ProgrammingError: (pymysql.err.ProgrammingError) (1146, "Table 'stocks_daily_basic_none.liseted stock list' doesn't exist")
[SQL: SELECT * FROM `liseted stock list`;]
(Background on this error at: http://sqlalche.me/e/f405)

Sun, 20 Sep 2020 14:27:05 stock_daily_price.py[line:130] ERROR ÈîôËØØÊó•ÂøóÔºö
Traceback (most recent call last):
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2285, in _wrap_pool_connect
    return fn()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 363, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 773, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 492, in checkout
    rec = pool._do_get()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/impl.py", line 139, in _do_get
    self._dec_overflow()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 69, in __exit__
    exc_value, with_traceback=exc_tb,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/impl.py", line 136, in _do_get
    return self._create_connection()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 308, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 437, in __init__
    self.__connect(first_connect_check=True)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 657, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 69, in __exit__
    exc_value, with_traceback=exc_tb,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 652, in __connect
    connection = pool._invoke_creator(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 488, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 599, in connect
    self._request_authentication()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 882, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/_auth.py", line 238, in caching_sha2_password_auth
    pkt = conn._read_packet()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 684, in _read_packet
    packet.check_error()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/protocol.py", line 220, in check_error
    err.raise_mysql_exception(self._data)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/err.py", line 109, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.InternalError: (1049, "Unknown database 'stocks_price_daily_none'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 126, in run
    self.get_data_and_save_bulk(status)
  File "/Users/Roy/Documents/Investment/Production/Stock/Data/individual_stock_data/price/stock_daily_price.py", line 105, in get_data_and_save_bulk
    pd.io.sql.to_sql(data, table_name, self.conn,index = None,if_exists = 'replace') ## change
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 518, in to_sql
    method=method,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1319, in to_sql
    table.create()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 641, in create
    if self.exists():
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 628, in exists
    return self.pd_sql.has_table(self.name, self.schema)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pandas/io/sql.py", line 1344, in has_table
    self.connectable.dialect.has_table, name, schema or self.meta.schema
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2171, in run_callable
    with self._contextual_connect() as conn:
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2251, in _contextual_connect
    self._wrap_pool_connect(self.pool.connect, None),
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2289, in _wrap_pool_connect
    e, dialect, self
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1555, in _handle_dbapi_exception_noconnection
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 2285, in _wrap_pool_connect
    return fn()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 363, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 773, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 492, in checkout
    rec = pool._do_get()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/impl.py", line 139, in _do_get
    self._dec_overflow()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 69, in __exit__
    exc_value, with_traceback=exc_tb,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/impl.py", line 136, in _do_get
    return self._create_connection()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 308, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 437, in __init__
    self.__connect(first_connect_check=True)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 657, in __connect
    pool.logger.debug("Error on connect(): %s", e)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/langhelpers.py", line 69, in __exit__
    exc_value, with_traceback=exc_tb,
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/util/compat.py", line 178, in raise_
    raise exception
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/pool/base.py", line 652, in __connect
    connection = pool._invoke_creator(self)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/strategies.py", line 114, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 488, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/__init__.py", line 94, in Connect
    return Connection(*args, **kwargs)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 325, in __init__
    self.connect()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 599, in connect
    self._request_authentication()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 882, in _request_authentication
    auth_packet = _auth.caching_sha2_password_auth(self, auth_packet)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/_auth.py", line 238, in caching_sha2_password_auth
    pkt = conn._read_packet()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/connections.py", line 684, in _read_packet
    packet.check_error()
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/protocol.py", line 220, in check_error
    err.raise_mysql_exception(self._data)
  File "/Users/Roy/anaconda3/envs/quant/lib/python3.6/site-packages/pymysql/err.py", line 109, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.InternalError: (pymysql.err.InternalError) (1049, "Unknown database 'stocks_price_daily_none'")
(Background on this error at: http://sqlalche.me/e/2j85)

Sun, 20 Sep 2020 15:14:03 stock_daily_price.py[line:114] WARNING some data download failed, check error ticks
Sun, 20 Sep 2020 15:14:03 stock_daily_price.py[line:115] WARNING ['688536.SH', '688127.SH', '605116.SH', '003006.SZ', '003003.SZ']
Sun, 20 Sep 2020 15:17:14 stock_daily_price.py[line:114] WARNING some data download failed, check error ticks
Sun, 20 Sep 2020 15:17:14 stock_daily_price.py[line:115] WARNING ['688536.SH', '688127.SH', '605116.SH', '003006.SZ', '003003.SZ']
Sun, 20 Sep 2020 15:17:21 stock_daily_price.py[line:114] WARNING some data download failed, check error ticks
Sun, 20 Sep 2020 15:17:21 stock_daily_price.py[line:115] WARNING ['688536.SH', '688127.SH', '605116.SH', '003006.SZ', '003003.SZ']
Tue, 22 Sep 2020 16:26:36 utils.py[line:129] INFO Note: NumExpr detected 12 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
Tue, 22 Sep 2020 16:26:36 utils.py[line:141] INFO NumExpr defaulting to 8 threads.
Tue, 22 Sep 2020 17:48:19 stock_daily_price.py[line:111] INFO Stock daily price_qfq data download successed!
